- provar a priori noves del ground truth (segons com millori --> anar al seguent pas)

	p = [0.3075    0.1892    0.1915    0.3099    0.0001    0.0007    0.0001    0.0002    0.0007    0.0001]

	accuracy la p del ground truth = 0.9772
	
	accuracy estimant la 'p' = 0.9757

	accuracy gatk = 0.9793



- provar diferents valors de N per comparar amb el GATK:

	en quina situació es millor que el GATK?

	N més petit i N més gran

	N = 370852 (9M) --> (4 %)


- provar amb menys coverage (retallar matriu F i Q) segons els learners. Borrar aleatoriament reads (aixi diem que tenim menys dades). Aqui es veurà com de sensible es el EM al treure coverage. Per exemple: veure quin es el coverage promig i restar-li el 10-20%... però com comparar amb GATK?

- Passar-li a en Panos les dades perquè ho faci amb el seu algorisme



------------------------------------------------------------------------------------
16-7-19

Fer una prova (del cas 1.2)


	provar calcul de alphas: dsd n=N fins 1

	el mateix amb les conf i les a priori. dsd m=M fins a 1


canviar probabilitats a priori (les AA i les TT son més probables)



MIRAR QUE PASSA A LES POSICIONS AL VOLTANT DE DELETIONS I INSERTIONS

ERR174324.52042287	147	20	989352	42	80M1D21M	=	989264	-190	AGCCCTGGAGGCAGAGGTTGCAGTGAGCCAAGATCGTGCCATTGCACTCCAGTCTGGGTGACAAGAGCAAGACTCCTCTCAAAAAAATAAATAAATAAATA	;><>AB@CABCACCCCBCCDDDBCCDDBC?CBBC<BCABBAAABCABAABBAABA@@ABAAB@AAABB@AAABA?A@A@A???????A>>?@>>??<<<==	MC:Z:101M	BD:Z:NNJNQQOMNOOOKKMMKJNNNLILKNNNLIILKLJHMMMLJIMMHMKLMMKLJMMILHKLHKIIJMMKIILMKLMKJKLJ@@@@@IGH@JHIAJIJCKIJJ	MD:Z:80^A7A13	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:NNKMRQNKMLMMKILMMLOOOOKNKOONOLMNNNNKOONNNLOOLONNNOONMOOKNKNOLOLMKONNKLNNMMMMLMMNEEEDDKIKCJHJCIGH>LJKK	NM:i:2	XM:i:1	XN:i:0	XO:i:1	MQ:i:42	AS:i:-14	YS:i:0	YT:Z:CP
ERR174324.162044628	83	20	989353	42	79M1D22M	=	989191	-264	GCCCTGGAGGCAGAGGTTGCAGTGAGCCAAGATCGTGCCATTGCACTCCAGTCTGGGTGACAAGAGCAAGACTCCTCTCAAAAAAATAAATAAATAAATAA	=;==7BBCCDCCCCCBACDCDBCDDDBDDDCCD=ACCACB@BBC@BBABAABCB@@AAAAB@AABBB@BBABA@BABAB@@@@@@@A@@AB@@AB@??<??	MC:Z:101M	BD:Z:NJNNQOMOOOOKLMMKJNNNLILKNNMKIILKLJHMMMLJIMMHMKLMMKLJMMILHKLHKIIJMMKIILMKLMKJKLKAAAAAJHIAJIJBKJKDMIJJJ	MD:Z:79^A7A14	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:NKMNRNKMLMMKILLMKNOOOKNKOONOLMNNNNKOONNNLOOLONNNNNMLOOKNJMNKNKLJNNNKLNNMMMMLMMNEEEEELJLELJLELJLEKJLKK	NM:i:2	XM:i:1	XN:i:0	XO:i:1	MQ:i:42	AS:i:-14	XS:i:-60	YS:i:0	YT:Z:CP
ERR174324.46751666	163	20	989360	42	72M1D29M	=	989588	329	AGGCAGAGGTTGCAGTGAGCCAAGATCGTGCCATTGCACTCCAGTCTGGGTGACAAGAGCAAGACTCCTCTCAAAAAAATAAATAAATAAATAATTGCAAG	<=<>>?@@??>@?@@@A@BB?BAA@@@;ABB@BA@BBBABA@BBAAACA@ACB@CABABBBABB@CBBABCBDCCBCA?>CAACCAB>BB@@CBCAA?=<@	MC:Z:101M	BD:Z:JJNNONKKMLJKLLLLGKJMLLIKJKLKJHMMMLJKMMHKJLMMMLIMMILHLLHIKJKNMIKJLKJLLJIJLJBBBBBKIJBKIJBKJKCLJLMNONNJL	MD:Z:72^A7A21	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:KKMNGJIJKLJLLMMMJLMOMNKMLMMLMKNMNMLOOOKOKMOOOOMONLOLNNKLNMNPOLNMNOKMNKMKNLFFFFFNKLFNJKDLIJDLJLOORNNKM	NM:i:2	XM:i:1	XN:i:0	XO:i:1	MQ:i:42	AS:i:-12	YS:i:0	YT:Z:CP
ERR174324.207598675	147	20	989371	42	61M1D40M	=	989143	-330	GCAGTGAGCCAAGATCGTGCCATTGCTCTCCAGTCTGGGTGACAAGAGCAAGACTCCTCTCAAAAAAATAAATAAATAAATAATTGCAAGGGTTCCAACAA	############B?B<CDC;BCCA=7*?CADCACCCBBA@AAAAAACCC??<5=@>A<@B?6=@@=@A>>@?B@@=B?;5:?;:?;-*A??>>8==;;::9	MC:Z:101M	BD:Z:JJJJMMLLKKKKNLMKINNNMKJNOLKLMMMKLJMMILHKLHKIIJMMKIILMKLMKJKLKAAAAAJHIAJHIAJHIAJGHIIHLLJHKILJJLNLLILJJ	MD:Z:26A34^A7A32	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:KKKKONMLKJJJLLLMJOONNNLOPNMNNNOONMOOKNKNOLOLMKOOOLMOONNNNMNNOFFFFFLJLELJLELJLELJLLMJMMMJKHKKJJJJEKNKK	NM:i:3	XM:i:2	XN:i:0	XO:i:1	MQ:i:42	AS:i:-15	YS:i:-9	YT:Z:CP
ERR174324.80492188	99	20	989374	40	58M1D43M	=	989419	147	GTGAGCCAAGATCGTGCCATTGCACTCCAGTCTGGGTGACAAGAGCAAGACTCCTCTCAAAAAAATAAATAAATAAATAATTGCAAGGGTTCCAACAAGTT	?A>@ABAB@BAAA;@AB@AA@BBAABA@ABABBB@@@AAAA@BABABABAAAA@AAAAB@@@@ABBCCCCCDDDCCACCADDCDCACBB@ACCC@AA=>>@	MC:Z:13M1D88M	BD:Z:JJIMNQOOJLKLLKJHMMMLJKMMHKJLMMMLIMMILHLLHIKJKNMIKJLKJLLJIJKIAAAAAJHIAJHIAJHJBKIJKKLNNJLNKNLMNPLMLJLNK	MD:Z:58^A7A35	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:KKKMLOMNKMLMMLMKNMNMLNNNJNJLNNNNLNMKNKMMJKMLMPOLNLMNJMNKMKNLFFFFFNKLFNKLFNKLFNKLNMONNKLLJMKKKNLONKMNL	NM:i:2	XM:i:1	XN:i:0	XO:i:1	MQ:i:40	AS:i:-13	YS:i:-13	YT:Z:CP
ERR174324.622280	83	20	989391	42	41M1D60M	=	989244	-249	CATTGCACTCCAGTCTGGGTGACAAGAGCAAGACTCCTCTCAAAAAAATAAATAAATAAATAATTGCAAGGGTTCCAACAAGTTTACTGTCATTGGACCTA	@?<@ABACCBCDBACCCCBDCCDDCDDDDBDBDCCBAACAB@@@@@@AB@@AB@@AB@@AB@BABBB@A@@A@A@B@AB@AA@@BAAAAABA@BAA??>??	MC:Z:101M	BD:Z:MKJNQKPNNOOMNKNNJMILMILJJKMMKIILMKLMKJKLKAAAAAJHIAJHIAJHIAJHIJJIMMKILILJJLMKJHKIKJAIKMMHLMMKJONOONMJJ	MD:Z:41^A7A52	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:MMKNRMOMLLMMLKMNJMKNOLOLMKOOOLMOONNNNMNNOFFFFFMKLELJMFMKLELJLLMKNNNKMJMMLMMNLKNKNMEKMNNJMMMMKNLNMMNKK	NM:i:2	XM:i:1	XN:i:0	XO:i:1	MQ:i:42	AS:i:-14	YS:i:0	YT:Z:CP
ERR174324.40142620	83	20	989392	42	40M1D61M	=	989141	-353	ATTGCACTCCAGTCTGGGTGACAAGAGCAAGACTCCTCTCAAAAAAATAAATAAATAAATAATTGCAAGGGTTCCAACAAGTTTACTGTCATTGGACCTAA	###?=AAB@CDBBCCCCBDCEDCDBCDDDDA?DBBCABAB@@@@A@BB@@BA@@B?@@BC@BAABB@A@@A@A@B@AB@AAA@BAA@AABA@BAA@@@=??	MC:Z:101M	BD:Z:JJJNLPNOOOMNLNNJMILMILJJKNMKIILMKLMKJKLKAAAAAJHIAJHIAJHIAJHIJJIMMKILILJJLMKJHKIKJAIKMMHLLMKJNNNOPMJJJ	MD:Z:40^A7A53	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:KKKNOPNMLMMLKMMJMJNOLOLMKOOOLMOONNNNMNNOFFFFFMKMELJLFMKMELJLLMKNNNKMJMMLMMNLKNKNMEKMNNJMMMMKNLNNLNLKK	NM:i:2	XM:i:1	XN:i:0	XO:i:1	MQ:i:42	AS:i:-14	YS:i:-2	YT:Z:CP
ERR174324.120572208	83	20	989400	42	32M1D69M	=	989265	-237	CCAGTCTGGGTGACAAGAGCAAGACTCCTCTCAAAAAAATAAATAAATAAATAATTGCAAGGGTTCCAACAAGTTTACTGTCATTGGACCTAAAGCCCACA	????@BBCCBCCDC@DCDDCDDDEDCCDDDCCA@@@@@BB@@AB@@AB@@AB@A@ABB@A@@AABAB@AB@AA@ABABAAABBAB@AAAAB@@BBA@@?@?	MC:Z:101M	BD:Z:NNLMNPPLNJMNJLJJKNNLJJMNLMMKJKLKAAAAAJHIAJHIAJHIAJHIJJIMMKILILJJLMKJHKIKJAIKMMHLLLJIMLLLMMJBJOOLPIIJJ	MD:Z:32^A7A61	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:MNNMPPOJLILMJMJLJNOOLMOONNNNMNNOFFFFFMKMFMKMFMKMELJLMNLONNKMJMMLMMNLKNKNMEKMNNJMMMMKNLNNMNLEKNNKLKKKK	NM:i:2	XM:i:1	XN:i:0	XO:i:1	MQ:i:42	AS:i:-14	YS:i:-2	YT:Z:CP
ERR174324.123346421	163	20	989411	42	21M1D80M	=	989532	222	GACAAGAGCAAGACTCCTCTCAAAAAAATAAATAAATAAATAATTGCAAGGGTTCCAACAAGTTTACTGTCATTGGACCTAAAGCCCACAAAAGTAAACGA	=><>=?@@@@?@?@?@?@AB@@??A???AB@@AB@@AB@@AB@A@BBA@B@@BAB@A@AAABBAACBCCBCDCBDBDBCDCAACDCCCBCAAACBA?=<8?	MC:Z:101M	BD:Z:JJMIKLKKNMIKIKJIKKIHIJIAAAAAJHIAJHIAJHIAJHIJJKMMIKMILJKLMIJHIKMJAIKKMHLKMKLNMMMMLJBLONJNJJKCCNPOMBKKM	MD:Z:21^A7A72	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:KKMJDIIJMLIKJLMIKLJLJMKEEEEEMJKEMJKFNKLFNKLNMOOOLNNLOMMMOLNKLNOMFMMOOLONNMONNNNNNLFNOMIMIIJDENPPOEMMM	NM:i:2	XM:i:1	XN:i:0	XO:i:1	MQ:i:42	AS:i:-14	YS:i:0	YT:Z:CP
ERR174324.80492188	147	20	989419	40	13M1D88M	=	989374	-147	CAAGACTCCTCTCAAAAAAATAAATAAATAAATAATTGCAAGGGTTCCAACAAGTTTACTGTCATTGGACCTAAAGCCCACAAAAGTAAACGAGAACTCAC	A?>?@BBBCABBC@@DAAABCAABB@@BCA@AB@BACBB@A@@AAAAB@AB@AA@@BBBAAABA@A@AA@BB@?@A??A@A???@@@?>?9?@?>>>>=;=	MC:Z:58M1D43M	BD:Z:LJJMQOOPMLMNMBBBBBKIJBKIJBKIJAJHIJJIMMKILILJJLMKJHKIKJAIKMMHLLLJIMLLLMLIAIMMIMHGJ@@HJJH@IJKJIKKNMMIJJ	MD:Z:13^A7A80	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:NKLNRPONMKLLMDDEEFMKMFMKMFMKMFMKMMNLOOOLNKNNMNNOMLOLONFLNOOKNNNNLOLNNMNLEKNNKMKKNEEJMKKDJKJHJIIJFMKKK	NM:i:2	XM:i:1	XN:i:0	XO:i:1	MQ:i:40	AS:i:-13	YS:i:-13	YT:Z:CP
ERR174324.125375919	99	20	989424	42	8M1D93M	=	989628	305	CTCCTCTCAAAAAAATAAATAAATAAATAATTGCAAGGGTTCCAACAAGTTTACTGTCATTGGACCTAAAGCCCACAAAAGTAAACGAGAACTCACATGCT	?@>?AABAB@@@@@?@B@@AB@AAB@@BB@A@BBA@B@@A@A@A@AA@BB@@BAABAAAA@B@AA@CCAACCCCDBCADACECBAB>CCCABDCBAA@>@A	MC:Z:101M	BD:Z:JJKMOMKLLJBBAAAJHIAJHIAJHIAJHIJJKMMIKMILJKLMIJHIKMJAIKKMHLKLJKMLLLLKIAKNMIMIIJBBLNLJBKKMMLLLMMNKLMMNN	MD:Z:8^A7A85	PG:Z:MarkDuplicates	RG:Z:1	XG:i:1	BI:Z:KKJLLJLJMKEEEEEMJKEMJKEMJKEMJKMLNNNKMMKNLLLNKNKLNNLELMOOLONNMONNNNNNLFNPNKOKKLFFNONKEMLLLKKLMJNLNMMNN	NM:i:2	XM:i:1	XN:i:0	XO:i:1	MQ:i:42	AS:i:-14	YS:i:0	YT:Z:CP



idoia 18-7-19
-------------

3-4% de posiciones va a tener variaciones

solo hay que evaluar la performance donde hay variaciones respecto a la referencia (los calls)

diferentes a:
		ref	class
		A	AA
		C	CC
		G	GG
		T	TT

		
los calls son (ejemplos):
		A	AC
		C	CG
		A	CC



dos listas comparando: una la nuestra y la otra el ground truth. Luego ver cuales han acertado y cuales no. Ver paper Idoia.



para los indels: ver cuantos casos estamos perdiendo! (%)




N=448.000 --> decideixo si hi ha call (positive) o no call (negative)

		call=20.000
		no_call = 428.000

dins del cercle = els meus calls
fora del cercle = molts que si estaran fora (true negatives) pero uns diré que no són calls pero si que ho són (false negative)


--> decidir call-no_call amb class
--> decidir call-no_call amb gt

CALL: Veure quins he fet bé i quins malament 
NO CALL: Veure quins he fet bé i quins malament

Fer servir la notació TP, FP, FN, TN --> calcular precision, recall (sensitivity) i F-score

Fer-ho al cas INDELS (cas 3) i al cas 2


A considerar:
 - pot ser que nosaltres no diem "CALL" pero perquè a la columna de la matriu tots els valors són iguals i per tant nosaltres no l'agafem.



REUNIÓN IDOIA 17-9-19

1. Amb només les dades del EM, calcular la precision / recall / FPR i TPR. Pintar la ROC i obtindrem un punt

2. Mirar quin paràmetre es pot tocar del EM per modificar TPR/FPR i pintar la curva ROC

3. Calcular precision i recall del GATK (tots els nucleotids). Aquí el TN es molt alt perquè l'espai d'observació és el genoma. Només calculem la precision i el recall.

P = TP / (TP+FP)	Recall = TP / (TP+FN)

4. Comparar GATK i EM (afegint les posicions obvies) i tornar a calcular performance.


5. Mirar els casos on l'EM diu que son TP i el GATK FN i veure si son especials. I igualment on nosaltre tenim TN i el GATK FP.


-----
mirar què passa amb els FP perquè n'hi ha masses.

2...
 - mirar probs a posteriori --> mirar les alphes! --> canviar el criteri (variar el threshold, hi haurà trade-off??)
 - veure si aquests FP son situacions rares / semblants
- mirar perquè detectem més TP


3...
- executar GATK i classificació GATK per inicialitzar les alphes. Executar l'EM amb aquestes dades


1...
- tornar a executar sense indels per veure si hem guanyat molt afegint els indels (TP, FP, FN).





